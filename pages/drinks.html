<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <link href="../styles/drinks.css" rel="stylesheet">
  <title>飲品介紹</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<div class="top-nav">
  <a href="login.html">
    <img src="../images/login.png" alt="登入圖示" style="width:50px; height:50px;">
  </a>
  <a href="home.html">首頁</a>
  <a href="most_new.html">最新資訊</a>
  <a href="drinks.html">飲品介紹</a>
  <a href="delivery.html">外送</a>
</div>

<div class="introduce" id="drinksContainer"></div>

<div id="drink-drift" class="drift">
  <div class="drift-content">
    <img id="modalImage" src="" alt="Drink Image" >
    <div id="modalName"></div>
    <div id="modalPrice"></div>
    <div id="modalDescription"></div>
  </div>
</div>

<script>
  // 將 openModal 函數移到全局作用域
  function openModal(image, name, price, description) {
    $("#modalImage").attr("src", "../" + image);
    $("#modalName").text(name);
    $("#modalPrice").text("價格: " + price);
    $("#modalDescription").text(description);
    $("#drink-drift").show();
  }

  function closeModal() {
    $("#drink-drift").hide();
  }

  $(document).ready(function() {
    $.ajax({
      url: '../php/getDrinks.php',
      type: 'GET',
      dataType: 'json',
      success: function(response) {
        if (response.success) {
          response.drinks.forEach(function(drink) {
            $('#drinksContainer').append(
              '<div class="responsive"><div class="gallery" onclick="openModal(\'' + drink.image + '\', \'' + drink.name + '\', \'' + drink.price + '\', \'' + drink.description + '\')">' +
              '<img src="../' + drink.image + '" alt="this is drink picture">' +
              '<div class="desc">' + drink.name + '</div></div></div>'
            );
          });
        } else {
          $('#drinksContainer').append('<p>' + response.message + '</p>');
        }
      },
      error: function() {
        $('#drinksContainer').append('<p>無法獲取飲品資訊。</p>');
      }
    });

    window.onclick = function(event) {
      if (event.target == $("#drink-drift")[0]) {
        closeModal();
      }
    }
  });
</script>

</body>
</html>
