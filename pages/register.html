<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <link href="../styles/register.css" rel="stylesheet">
    <title>註冊</title>
    <script src="../js/jquery-3.7.1.min.js"></script>
</head>

<body>
    <div class="top-nav">
        <a href="login.html">
            <img src="../images/login.png" alt="登入圖示" style="width:50px; height:50px;">
        </a>
        <a href="home.html">首頁</a>
        <a href="most_new.html">最新資訊</a>
        <a href="drinks.html">飲品介紹</a>
        <a href="delivery.html">外送</a>
    </div>

    <div class="login-window">
        <div class="login-form">
            <h1>註冊</h1>
            <form id="register-form" action="register.php" method="post">
                <div class="name">
                    <input type="text" name="name" placeholder="姓名" required>
                </div>
                <div class="address">
                    <input type="text" name="address" placeholder="地址" required>
                </div>
                <div class="phone">
                    <input type="text" name="phone" placeholder="電話" required>
                </div>
                <div class="account">
                    <input type="text" name="account" placeholder="使用者名稱" required>
                </div>
                <div class="password">
                    <input type="password" name="password" placeholder="密碼" required>
                </div>
                <div class="repassword">
                    <input type="password" name="repassword" placeholder="重複輸入密碼" required>
                </div>
                <div class="btn-register">
                    <button type="submit">註冊</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $('#register-form').on('submit', function (e) {
                e.preventDefault(); // 防止表單的正常提交
                $.ajax({
                    url: '../php/register.php', // PHP 處理腳本的路徑
                    type: 'POST', // 請求類型
                    data: $(this).serialize(), // 序列化表單數據
                    dataType: 'json', // 設置數據類型
                    success: function (response) {
                        $('.error').remove(); // 移除之前的錯誤訊息
                        if (response.error) {
                            $('.login-form').append('<div class="error">' + response.message + '</div>');
                        } else {
                            // 註冊成功的處理
                            $('.login-window').addClass('success');
                            $('.login-form').html('<h1>註冊成功，等待跳轉頁面!</h1>');
                            // 可以選擇重定向到登錄頁或其他操作
                            console.log('註冊成功');
                            setTimeout(() => {
                                console.log('註冊成功');
                                window.location.href = 'home.html';
                            }, 2000);
                        }
                    },
                    error: function (xhr, status, error) {
                        $('.error').remove(); // 移除之前的錯誤訊息
                        $('.login-form').append('<div class="error">發生錯誤，請稍後再試。</div>');
                        console.log("AJAX error: " + status + ' : ' + error);
                        console.log(xhr.responseText); // 如果有的話，這將顯示服務器的回應文本
                    }
                });
            });
        });
    </script>
</body>

</html>